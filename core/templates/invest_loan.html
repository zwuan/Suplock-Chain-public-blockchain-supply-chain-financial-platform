<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    {% load static %}
    {% include 'nav_login.html' %} 
    <link rel="stylesheet" href="{%static 'css/invest_loan.css' %}">
</head>
<body>
    <main class="main_content">
        <form action="" method="POST">
        <div class="invest_form">
            <div class="card_title">
                <h2 class="title_text wh">投資:DE-123</h2>
                <h2 class="title_text wh">轉入代幣</h2>
            </div>
            <h2 class="buy_label wh">申購金額:</h2>
            <div class="buy_input">
                <input type="text" name="buy_amount" id="amount" class="buy_amount" placeholder = "請輸入金額">
                <h3 class="wh">|</h3>
                <h6 class="wh buy_all" id = "click_all">全部</h6>
            </div>
            <div class="balance">
                <div class="circle"><img class='whSVG' src="{% static 'icon/wallet.svg' %}" width="24px" height="24px" alt=""></div>
                <div class="money_info">
                    <h2 class="tw4 wh fourW" id = "balance" value = "21000">21,000 TWD</h2>
                    <h2 class="wh forte fourW">平台幣餘額</h2>
                </div>
            </div>
            <div class="confirm_loan">
                <select name="pets" class="select-1" id="select-1">
                    <option value="">選擇風險等級</option>
                    <option  value="4">A: 年化利率4%</option>
                    <option  value="6" >B: 年化利率6%</option>
                    <option  value="9" >C: 年化利率9%</option>
                </select>
            </div>
            <div class="loan_detail">
                <h2 class="wh sixte mabt5" id="ref_income">參考收益: </h2>
                <h2 class="wh sixte mabt5">申購門檻:  5,000</h2>
                <h2 class="wh sixte mabt5">生效日期:  2021-07-22</h2>
                <h2 class="wh sixte mabt5">截止日期:  2021-10-22</h2>
            </div>
            <button class="confirm_btn" disabled = "disabled" id = 'btn'>確認投資</button>
            <button class="confirm_btn" disabled = "disabled" id = 'btn-real' style="display: none;">確認投資</button>
        </div>
    </form>
    </main>
    
    
</body>
<script>
    function numberWithCommas(x) {
            x = x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            return x;
        }       
    $('#amount').on('input',function(){
        if ($('#amount').val().length){
            $('#btn-real').prop('disabled', false);
            $('#btn-real').css('display', "block");
            $('#btn').css("display","none");
            set_ref();
            
        }else{
            $('#btn-real').prop('disabled', true);
            $('#btn-real').css('display', "none");
            $('#btn').css("display","block")
        }
    });
    $('#click_all').on('click', function(){
        $('#amount').val($('#balance').attr('value'));
        $('#btn').css("display","none");
        $('#btn-real').css('display', "block");
        $('#btn-real').prop('disabled', false);
        set_ref(); 
    });
    $('#select-1').change(function(){
        set_ref();
    });
    function set_ref() {
        const interest = ($('#select-1').val()) / 100;
        const amount = $('#amount').val();
        let reference = parseInt(amount * interest / 4);
        let ref_income = numberWithCommas(reference);
        let str_ref_income = "參考收益: " + ref_income;
        $('#ref_income').html(str_ref_income);
        return str_ref_income
    }
  
</script>
</html>